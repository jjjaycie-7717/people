<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>任务管理 - 管理后台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="miniprogram-container">
        <!-- 导航栏 -->
        <div class="navbar" style="background: linear-gradient(135deg, #1e293b 0%, #334155 100%);">
            <div class="flex items-center justify-between w-full">
                <h1 class="text-lg font-bold">
                    <i class="fas fa-tasks mr-2"></i>
                    任务管理
                </h1>
            </div>
        </div>

        <!-- 任务筛选 -->
        <div class="bg-white mx-3 mt-3 rounded-xl shadow-sm p-3">
            <!-- 操作区域 -->
            <div class="mb-3">
                <button class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors" onclick="createTask()">
                    <i class="fas fa-plus mr-1"></i>
                    发布任务
                </button>
            </div>

            <!-- 状态筛选 -->
            <div class="grid grid-cols-4 gap-1 mb-3">
                <button class="py-1 bg-blue-600 text-white rounded-lg text-xs font-medium filter-btn active" data-status="all">
                    全部
                </button>
                <button class="py-1 bg-gray-100 text-gray-600 rounded-lg text-xs font-medium filter-btn" data-status="active">
                    进行中
                </button>
                <button class="py-1 bg-gray-100 text-gray-600 rounded-lg text-xs font-medium filter-btn" data-status="completed">
                    已完成
                </button>
                <button class="py-1 bg-gray-100 text-gray-600 rounded-lg text-xs font-medium filter-btn" data-status="expired">
                    已过期
                </button>
            </div>

            <!-- 发布时间和搜索 -->
            <div class="flex items-center space-x-2">
                <input type="date" id="publishDate"
                       class="px-2 py-1 border border-gray-300 rounded-lg text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent">
                <button class="bg-gray-100 text-gray-600 px-2 py-1 rounded-lg text-xs" onclick="clearDateFilter()">
                    <i class="fas fa-times"></i>
                </button>
                <div class="flex-1">
                    <input type="text" placeholder="搜索任务..."
                           class="w-full px-2 py-1 border border-gray-300 rounded-lg text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent">
                </div>
                <button class="bg-gray-100 text-gray-600 px-2 py-1 rounded-lg text-xs">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>

        <!-- 任务列表 -->
        <div class="px-3 py-2">
            <!-- 任务卡片1 - 进行中 -->
            <div class="bg-white rounded-xl shadow-sm p-4 mb-4 fade-in" data-status="active" data-publish-date="2024-12-20">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <h3 class="font-bold text-lg">周末大促销活动</h3>
                        <p class="text-sm text-gray-600 mt-1">转发促销推文到朋友圈</p>
                    </div>
                    <span class="status-badge status-pending">进行中</span>
                </div>
                <div class="bg-gray-50 rounded-lg px-3 py-2 mb-3">
                    <div class="flex items-center text-sm text-gray-500">
                        <i class="fas fa-calendar-alt mr-2 text-blue-500"></i>
                        <span>2024-12-20 09:00 至 今日 18:00</span>
                    </div>
                </div>
                <!-- 任务统计 -->
                <div class="grid grid-cols-3 gap-3 mb-4">
                    <div class="bg-blue-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-blue-600">12</div>
                        <div class="text-xs text-gray-600 mt-1">参与员工</div>
                    </div>
                    <div class="bg-green-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-green-600">8</div>
                        <div class="text-xs text-gray-600 mt-1">已完成</div>
                    </div>
                    <div class="bg-orange-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-orange-600">67%</div>
                        <div class="text-xs text-gray-600 mt-1">完成率</div>
                    </div>
                </div>

                <!-- 推文内容预览 -->
                <div class="bg-gray-50 rounded-lg p-3 mb-4">
                    <div class="flex items-start space-x-3">
                        <img src="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=60&h=60&fit=crop&crop=center" 
                             alt="促销活动" class="w-15 h-15 rounded-lg object-cover">
                        <div class="flex-1">
                            <h4 class="font-semibold text-gray-800 text-sm">🎉 周末特惠！全场8折起</h4>
                            <p class="text-xs text-gray-600 mt-1">精选商品限时优惠，错过再等一年！</p>
                        </div>
                    </div>
                </div>

                <!-- 操作按钮 -->
                <div class="flex space-x-2">
                    <button class="flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium" onclick="viewSubmissions('task1')">
                        提交情况
                    </button>
                    <button class="bg-gray-100 text-gray-600 py-2 px-3 rounded-lg text-sm font-medium">
                        编辑
                    </button>
                    <button class="bg-gray-100 text-gray-600 py-2 px-3 rounded-lg text-sm font-medium" onclick="deleteTask('task1')">
                        删除
                    </button>
                </div>
            </div>

            <!-- 任务卡片2 - 已完成 -->
            <div class="bg-white rounded-xl shadow-sm p-4 mb-4 fade-in" data-status="completed" data-publish-date="2024-12-19">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <h3 class="font-bold text-lg">新品上市推广</h3>
                        <p class="text-sm text-gray-600 mt-1">转发新品视频到朋友圈</p>
                    </div>
                    <span class="status-badge status-completed">已完成</span>
                </div>
                <div class="bg-gray-50 rounded-lg px-3 py-2 mb-3">
                    <div class="flex items-center text-sm text-gray-500">
                        <i class="fas fa-check-circle mr-2 text-green-500"></i>
                        <span>2024-12-19 14:00 至 2024-12-20 16:30</span>
                    </div>
                </div>
                <!-- 任务统计 -->
                <div class="grid grid-cols-3 gap-3 mb-4">
                    <div class="bg-blue-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-blue-600">10</div>
                        <div class="text-xs text-gray-600 mt-1">参与员工</div>
                    </div>
                    <div class="bg-green-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-green-600">10</div>
                        <div class="text-xs text-gray-600 mt-1">已完成</div>
                    </div>
                    <div class="bg-green-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-green-600">100%</div>
                        <div class="text-xs text-gray-600 mt-1">完成率</div>
                    </div>
                </div>

                <!-- 视频内容预览 -->
                <div class="bg-gray-50 rounded-lg p-3 mb-4">
                    <div class="relative">
                        <img src="https://images.unsplash.com/photo-1556742111-a301076d9d18?w=100%&h=100&fit=crop&crop=center" 
                             alt="新品视频" class="w-full h-24 rounded-lg object-cover">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="bg-black bg-opacity-50 rounded-full p-2">
                                <i class="fas fa-play text-white text-lg"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-2 right-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded">
                            2:30
                        </div>
                    </div>
                    <h4 class="font-semibold text-gray-800 mt-2 text-sm">🌟 全新有机蔬菜系列上市</h4>
                    <p class="text-xs text-gray-600 mt-1">新鲜直达，健康生活从选择开始</p>
                </div>

                <!-- 操作按钮 -->
                <div class="flex space-x-2">
                    <button class="flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium" onclick="viewSubmissions('task2')">
                        提交情况
                    </button>
                    <button class="bg-gray-100 text-gray-400 py-2 px-3 rounded-lg text-sm font-medium" disabled>
                        已完成
                    </button>
                    <button class="bg-gray-100 text-gray-600 py-2 px-3 rounded-lg text-sm font-medium" onclick="deleteTask('task2')">
                        删除
                    </button>
                </div>
            </div>

            <!-- 任务卡片3 - 已过期 -->
            <div class="bg-white rounded-xl shadow-sm p-4 mb-4 fade-in" data-status="expired" data-publish-date="2024-12-18">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <h3 class="font-bold text-lg">节日促销活动</h3>
                        <p class="text-sm text-gray-600 mt-1">转发节日促销海报</p>
                    </div>
                    <span class="status-badge status-rejected">已过期</span>
                </div>
                <div class="bg-gray-50 rounded-lg px-3 py-2 mb-3">
                    <div class="flex items-center text-sm text-gray-500">
                        <i class="fas fa-times-circle mr-2 text-red-500"></i>
                        <span>2024-12-18 10:00 至 2024-12-19 18:00</span>
                    </div>
                </div>
                <!-- 任务统计 -->
                <div class="grid grid-cols-3 gap-3 mb-4">
                    <div class="bg-blue-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-blue-600">8</div>
                        <div class="text-xs text-gray-600 mt-1">参与员工</div>
                    </div>
                    <div class="bg-green-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-green-600">5</div>
                        <div class="text-xs text-gray-600 mt-1">已完成</div>
                    </div>
                    <div class="bg-orange-50 rounded-lg p-3 text-center">
                        <div class="text-xl font-bold text-orange-600">63%</div>
                        <div class="text-xs text-gray-600 mt-1">完成率</div>
                    </div>
                </div>

                <!-- 海报内容预览 -->
                <div class="bg-gray-50 rounded-lg p-3 mb-4">
                    <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=100%&h=100&fit=crop&crop=center" 
                         alt="节日促销海报" class="w-full h-24 rounded-lg object-cover">
                    <h4 class="font-semibold text-gray-800 mt-2 text-sm">🎊 节日特惠大促销</h4>
                    <p class="text-xs text-gray-600 mt-1">限时优惠，错过再等一年！</p>
                </div>

                <!-- 操作按钮 -->
                <div class="flex space-x-2">
                    <button class="flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium" onclick="viewSubmissions('task3')">
                        提交情况
                    </button>
                    <button class="bg-gray-100 text-gray-400 py-2 px-3 rounded-lg text-sm font-medium" disabled>
                        已过期
                    </button>
                    <button class="bg-gray-100 text-gray-600 py-2 px-3 rounded-lg text-sm font-medium" onclick="deleteTask('task3')">
                        删除
                    </button>
                </div>
            </div>
        </div>


        <!-- 底部间距 -->
        <div class="h-20"></div>
    </div>

    <script>
        // 任务筛选
        document.querySelectorAll('.filter-btn').forEach(button => {
            button.addEventListener('click', function() {
                // 移除所有按钮的激活状态
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('bg-gray-100', 'text-gray-600');
                });
                
                // 激活当前按钮
                this.classList.remove('bg-gray-100', 'text-gray-600');
                this.classList.add('bg-blue-600', 'text-white');
                
                // 筛选任务
                const status = this.getAttribute('data-status');
                const tasks = document.querySelectorAll('.task-card');
                
                tasks.forEach(task => {
                    if (status === 'all' || task.getAttribute('data-status') === status) {
                        task.style.display = 'block';
                    } else {
                        task.style.display = 'none';
                    }
                });
            });
        });

        // 发布任务
        function createTask() {
            window.location.href = 'admin-create-task.html';
        }

        // 编辑任务
        document.addEventListener('click', function(e) {
            if (e.target.closest('button') && e.target.closest('button').textContent.includes('编辑')) {
                alert('跳转到编辑任务页面');
            }
        });

        // 查看详情
        document.addEventListener('click', function(e) {
            if (e.target.closest('button') && e.target.closest('button').textContent.includes('详情')) {
                alert('跳转到任务详情页面');
            }
        });

        // 查看提交情况
        function viewSubmissions(taskId) {
            window.location.href = 'admin-task-submissions.html?taskId=' + taskId;
        }

        // 删除任务
        function deleteTask(taskId) {
            if (confirm('确定要删除这个任务吗？删除后无法恢复。')) {
                // 找到对应的任务卡片并移除
                const taskCard = document.querySelector(`[data-status]`);
                if (taskCard) {
                    taskCard.remove();
                    alert('任务已删除');
                }
            }
        }

        // 清除日期筛选
        function clearDateFilter() {
            document.getElementById('publishDate').value = '';
            // 显示所有任务
            const tasks = document.querySelectorAll('[data-status]');
            tasks.forEach(task => {
                task.style.display = 'block';
            });
        }

        // 日期筛选功能
        document.getElementById('publishDate').addEventListener('change', function() {
            const selectedDate = this.value;
            const tasks = document.querySelectorAll('[data-status]');
            
            if (selectedDate) {
                // 这里可以根据任务的发布时间进行筛选
                // 示例：假设任务卡片有data-publish-date属性
                tasks.forEach(task => {
                    const taskDate = task.getAttribute('data-publish-date');
                    if (taskDate === selectedDate) {
                        task.style.display = 'block';
                    } else {
                        task.style.display = 'none';
                    }
                });
            } else {
                // 如果没有选择日期，显示所有任务
                tasks.forEach(task => {
                    task.style.display = 'block';
                });
            }
        });
    </script>
</body>
</html>
